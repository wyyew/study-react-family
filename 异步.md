> 在react与redux的应用中，我们一般是这样从服务器请求数据的：

1. 编写action创建函数，执行网络请求加载数据。

2. 判断网络请求是否成功，并在网络请求前后分别发起相应的action.

3. 编写reducer, 根据相应的action来更新state.


## 异步action创建函数

redux中的异步操作几乎都在action创建函数中进行。 action创建函数原本只能实现同步操作，但是可以通过Thunk中间件编写异步action创建函数。所谓异步action创建函数，其实就是包含异步请求的action创建函数。

```
//action/index.js
function fetchPosts(reddit) {
  return dispatch => {
    dispatch(requestPost(reddit));
    return fetch(`https://www.reddit.com/r/${reddit}.json`)
      .then(response => response.json())
      .then(json => dispatch(receivePosts(reddit, json));
  };
}

```

在上述异步action创建函数中，我们不公使用fetch()方法进行了异步请求，还在异步请求的前后分别发起了requestPosts()和receivePosts()这两个action创建函数去改变state。

## 异步请求前后的state变化

```
//action/index.js
funciton requestPosts(reddit) {
  return {
    type: REQUEST_POST,
    reddit
  };
}

function receivePost(reddit, json) {
  return {
    type: RECIVE_POSTS,
    reddit,
    posts: json.data.children.map(child => child.data),
    receivedAt: Date.now()
  };
}

requestPosts() 和 receivePosts() 主要改变了state tree中的isFetching和didInvalidate等节点：
```

```
...
case REQUEST_POSTS:
      return Object.assign({}, state, {
        isFetching: true,
        didInvalidate: false
      });
case RECEIVE_POSTS:
    return Object.assign({}, state, {
      isFetching: false,
      didInvalidate: false,
      items: action.postes,
      lastUpdated: action.receivedAt
    });
 ...
```
